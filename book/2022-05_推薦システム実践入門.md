# 2022-05_推薦システム実践入門

# 書籍情報

- [O'Reilly Japan - 推薦システム実践入門](https://www.oreilly.co.jp/books/9784873119663/)

# コード

あれば後で追記

# 読書会

[推薦システム実践入門読書会](https://www.notion.so/ec0771cb7cb84143a63225d0875f830d?pvs=21)

# 1章 推論システム(～P.14)

## 1.1 推薦システム

- 推論システムの定義
    - 価値あるものの抽出＋意思決定の支援

## 1.2 推薦システムの歴史

なし

## 1.3 推薦システムの種類

- インプットは
    - コンテンツ情報
        - これをベースにするとcontent-based filtering
    - インタラクション情報
        - これをベースにすると協調フィルタリング
- 推薦の計算
    - パーソナライズなし
        - 新着順、人気度順
        - ニュースなど流動性が高い場合は有効
    - 関連アイテム推薦
        - アイテム間の類似度を利用
        - コンテンツベースと協調フィルタリング双方で行える
        - 類似度自体もアイテムそのものの類似性より共起性で定義する場合もある
            - プリンターと付属品（インク）
        - ハリーポッター問題
            - 多くの人が他のアイテムと一緒にハリーポッターを購入していたので、他のアイテムの関連アイテム推薦がすべてハリーポッターとなった
            - 人気のアイテムの影響は取り除く必要がある
    - パーソナライズ推薦
        - １人１人にパーソナライズする計算
        - こちらもコンテンツベースと協調フィルタリング双方で行える
        - コンテンツベース
            - ユーザの年齢や住所に合った求人の推薦
        - 行動履歴ベースの例
            - 単純に閲覧履歴を載せるのもアリ
            - 動画や音楽サイトなど再閲覧することがおおい分野では効果的
            - ECでも再購入するようなものは該当
- アウトプット
    - 詳しくは３章で

## 1.4 検索システムと推薦システム

- ２つは似ている
- PageRankと呼ばれるアルゴリズム
    - 重要なリンクが集まっているウェブサイトを重要と見なす
- ２つの違い
    - Pull型かPush型か
    - 検索は能動的(Pull)で、推薦は能動的(Push)
- 多くのサービスは組み合わせている
    - 検索ワードを元に、このアイテムもオススメする、など

## 1.5 まとめ

なし

# 2章 推薦システムのプロジェクト(～P.26)

## 2.1 推薦システム開発に必要な３つのスキル

- ビジネス力、データサイエンス力、データエンジニアリング力
- KGI、KPI
- すべてを兼ね備えた人はまれ（泣）

<<<2024-03-06 : p.18>>>

## 2.2 推薦システムのプロジェクトの進め方

- 課題定義
    - KPIから定量的な分析
    - 現状の課題に落とし込み、重要度を付ける
- 仮説立案
    - ROIが高い施策から取り組む
        - 推薦よりも検索システムの機能改善やデザイン改良の方が、ROIが高いケースも
    - 一度立ち止まって、推薦システムが費用対効果が高いのか再検討することが重要
    - 推薦にも様々な種類があるため、ユーザのニーズに合わせて選択すべき
- データ設計・収集・加工
    - サービスの初期段階ではインタラクションデータがないことも多いので、アイテム情報を使った推薦から検討することが多い
- アルゴリズム選定
    - 初期は簡単なアルゴリズムを使う
- 学習、チューニング
    - ビジネス再度と議論する場合は定性的な分析が重要
    - 精度はある程度のところで良いはず
- システム実装
    - バッチ推薦とリアルタイム推薦
    - リアルタイム推薦はエンジニアリング的に難易度が高い
- 評価、改善
    - 理想的にはABテスト
    - ABテストが難しい場合はリリース前後をトレンドなどを考慮した上で評価が必要
        - 現実には困難だろう、という印象
    - 推薦システムだけではなく全体を見て悪影響がないか
        - 検索システム経由の売り上げが下がってないか、など

## 2.3 まとめ

なし

# 3章 推薦システムのUI/UX(～P.58)

## 3.1 UI/UXの重要性

- 高度な推薦アルゴリズムができたとしても、適切な形で届けなければその価値は届かない
    - ユーザの意思決定を支援できない
- ユーザ側の目的とサービス提供者側の目的を分類し、それぞれを達成するUI/UXについて紹介

## 3.2 サービスを利用するユーザーの目的に応じたUI/UX事例

- 適合アイテム発見（find good items）
    - ユーザの目的が達成されるのに十分な程度にユーザの好みに適合したアイテムを1つでもよいので確実に発見したいケース
        - 例：東京駅付近で飲食店を探している
    - リスト表示、情報量を取捨選択する
        - 料理や店内の写真（例：食べログ）
        - Uber Eatsの場合に店内の写真は不要
    - 複数のリストを提示する
        - リストの並び順を複数種類準備するUIを備える
        - リストを横並びにする
    - スライドで気に入ったか否かをフィードバックさせる
        - マッチングアプリなど
        - 明確なフィードバックを得られるのがメリット
            - ネガティブなフィードバックも多く集められる

<<<2024-03-10 : p.33>>>

- 適合アイテム列挙（find all good items）
    - すべてを列挙する点がポイント
    - 引っ越し先の賃貸物件などは自分の好みの候補をなるべくたくさん閲覧したいはず
    - 旅行プラン決めなど、利用頻度が低く、コストがかかるものでこの傾向がみられる
    - 特許などもこれに該当
        - この場合、検索システムの方に該当する可能性も高い
    - 件数が少なるなる場合は敢えて条件を一部満たさないものも入れると効果的
        - 徒歩5分以内は少ないため、7分以内にする、など
- アイテム系列消費
    - 系列全体で価値を提示するもの（Spotifyの音楽を次々と再生する機能など）
    - 好みの音楽と未知の音楽の割合のコントロールが重要
- サービス内回遊
    - すぐには購入の意志がないユーザには購入を促す推薦は逆効果
    - 特定のテーマに沿った特集の提示などが効果的

<<<2024-03-11 : p.37>>>

## 3.3 サービス提供者の目的に応じたUI/UX事例

- 新規、低頻度ユーザーの定着
    - 定着してもらうためには、良い体験を提供するだけでなく、悪い体験をさせないことも同じくらい重要
    - 概要推薦が良く用いられる
        - 統計情報やサービスの知識が豊富な編集者の選択に基づいた推薦のこと
            - 例：今週の視聴ランキング
        - 大部分のユーザーにとってある程度のニーズを満たすことが多く、ニーズを外したとしても大きく外すことが少ない
- サービスへの信頼性向上
    - 利用者評価が有効な場合
    - サービス内のユーザー間での推薦を実現するもの
    - Amazon（https://www.amazon.com/）では、日本以外からのレビューを非表示にする機能を提供することでレビューの質を担保
    - Netflixでは、ユーザーはアカウント作成直後に図3-7のような画面で明示的に自分の好きな作品を選ぶ
- 利用頻度向上・離脱ユーザーの復帰
    - 通知サービス（notification services）が有効
    - サービスを利用していないユーザに送るため、不快にならないことが重要
    - 通知の頻度、タイミングなど
- クロスセル
    - 関連アイテム推薦が有効な手段
    - スマートフォンを購入しようと買い物かごに入れているユーザーに、スマホカバーなどのアクセサリを推薦
    - 関連アイテム推薦の枠組みでユーザーが注目しているアイテムと同等の類似アイテムを表示し、商品の比較を促して購買の判断を助ける
- 長期的なユーザーのロイヤルティ向上
    - Personalize（個人化）はユーザに明確に示した方が効果が高くなる
            - 「あなたにおすすめのコンテンツ」のような説明を付与
        - 一方で個人化がずれている場合はがっかりする
            - 無闇に個人化をするべきではなくある程度のデータと精度が担保された状態で個人化をするべき
        - 関心を持たないものに対して明示的にフィードバックできる仕組みを用意することも手段の1つ
        - システムに嗜好情報として扱わないように伝えることができる機能も重要
        - 大部分はフィードバックを得られないため、それを想定して設計する
            - どうやって？？
    - 高度に個人化され過ぎることはユーザー体験を損ねる可能性もある
        - 恐怖感、不信感、不快感
        - どのような情報を取得してどのように利用しているのかを明示することで軽減
        - あえて個人化できないような設定も準備する

## 3.4 関連トピック

- 推薦システムのUI/UXに関連の深いトピックを紹介
- アイテムの「類似度」
    - プリンターを購入したユーザに類似度の高いプリンターを推薦しても意味がない
        - インクなどの付属品を推薦した方がよい
    - アイテム同士の「類似度」は、用いる基準次第で大きく変わる
        - ジャンル、監督、公開時期、出演者
- 目新しさ・セレンディピティ・多様性
    - 目新しさ（novelty）
        - 「関心」と「新規性」の両方を満たす
        - 好きな作家の新作など
        - 新規性が高くても、関心が低いものを進めても意味がない
    - セレンディピティ（serendipity）
        - 「意外性」の要素が加わった概念
        - 好きな作家とよく似た作風の新人作家の作品を推薦
        - セレンディピティは定量的に測定が難しいので、多様性（diversity）という観点で定量的に測定することがある
        - サービスを使い始めたばかりのユーザーに対しては、順当にユーザーに適合するアイテムを推薦する
        - ある程度サービスを利用し続けているユーザーに対しては、サービスへの飽きを解消するためにセレンディピティのあるアイテム推薦を行う
- 推薦アイテムの選別
    - どれほど予測評価値が高いとしてもユーザーに提示すべきでないアイテムが存在する
        - 一度購入した本をもう一度ユーザーが購入してくれることは珍しい
            - 一方でアイテムにもよる（飲料水など）
            - 再購入予測モデル自体を作成する必要があるように思える（アイテム毎に再購入される期間を予測する、など？）
            - 「再度購入」のような機能を別途追加することで再購入はそちらの経路に任せる
        - 何度も表示されたが購入に至っていないアイテム
            - 一定の回数表示されたアイテムはユーザーに表示されなくなるという機能を追加することが有効
            - アイテムによっては購入の意思決定までに時間がかかる
            - ある程度の回数は表示することが必要な場合もあるのでアイテムの性質を考慮した上で設計する必要がある
                - たとえば、家や自動車などの比較的大きな買い物
            - 「閲覧履歴」のように同じアイテムを閲覧するための経路を別途提供するのも有効
- 推薦理由の提示
    - 推薦の効果、推薦の透明性、ユーザーの満足度を向上させられる
    - 推薦の透明性が高いと、推薦自体の効果を高めるだけではなく、システムへの信頼性を高める効果もある
        - ユーザーが視聴したアイテム（この例では「ダンジョンに出会いを求めるのは間違っているだろうか」というアニメ）に基づいた推薦であることを推薦理由として提示
        - 「睡眠」というカテゴリを提示しながら、睡眠をとろうとする際に聴くとよい音楽を推薦
    - ユーザーがどれくらいアイテムを好むと予測しているかを5 段階評価などで定量的に示す
    - 明示的に推薦理由を提示しているにかかわらずユーザーの好みのアイテムを推薦できなければ、逆にユーザーのシステムへの信頼性や満足度を失う危険性もある

## 3.5 まとめ

- 推薦システムにおける適切なUI/UX はサービスによって千差万別であり、都度適切なものを考えることが重要
- この思考を養うには、普段からさまざまなサービスに触れて、開発者がどのように考えてそのUI/UX を提供するに至ったかを考えること、デザインやプロダクトマネジメントといった領域、あるいは行動経済学などの分野について学ぶことも役立つ

<<<2024-03-11 : p.57>>>


# 4章 推薦アルゴリズムの概要(～P.86)

# 5章 推薦アルゴリズムの詳細(～P.174)

# 6章 実システムへの組み込み(～P.196)

# 7章 推薦システムの評価(～P.230)

# 8章 発展的なトピック(～P.250)

# 付録A Netflix Prize(～P.262)

# 付録B ユーザー間型メモリベース法の詳細(～P.272)