# 数学について

## 【ベイズ統計その①】条件付き確率と Bayes の定理【時間の流れを意識せよ！】

- 参考
  - [https://www.youtube.com/watch?v=mX_NpDD7wwg](https://www.youtube.com/watch?v=mX_NpDD7wwg)

### 確率とは

- 部分 / 全体。
- Uを全体、Aを事象とすると以下。

$$ P(A) = \frac{A}{U} $$

- 例としては、サイコロで、事象Aを偶数がでるとすると
 
$$ U = \{1,2,3,4,5,6\} $$

$$ A = \{2,4,6\} $$

### 条件付き確率

- 条件付き確率。たとえば、Aが起こる場合にBが起こる確率。

$$ P(B|A) = \frac{A \land B}{A} $$

- 右辺の分子分母を全体 $$ U $$で割ると

$$ P(B|A) = \frac{\frac{A \land B}{U}}{\frac{A}{U}} $$

- つまり以下。

$$ P(B|A) = \frac{P(A \land B)}{P(A)} $$

- ここから以下も正しい。

$$ P(A \land B) = P(B|A)P(A)$$

- AとBを逆にしてももちろん成立する。

$$ P(A|B) = \frac{P(A \land B)}{P(B)} $$

### ベイズの定理

$$ P(A|B)=\frac{P(B|A)P(A)}{P(B)}$$

- 証明は簡単で、反転させた式で$$ P(A \land B) $$を消せば成り立つ。

### 順行と逆行

- 問題
  - 袋Xに赤３、白５
  - 袋Yに赤１、白３
  - 確率1/2でX,Yを選んで袋を選び、玉を取り出す。
  - 袋Xをえらぶ事象をA、赤玉を引く事象をBとする。
- この時の$$ P(A),P(B),P(A|B),P(B|A),P(A \land B) $$を求めることを考える。
- このとき以下は問題より直接求まる。

$$ P(A) = 1/2 $$

$$ P(B|A) = 3/8 $$

- 計算により以下も求まる。

$$ P(B) = 1/2 \times 3/8 + 1/2 \times 1/4 = 5/16 $$

$$ P(A \land B) = 1/2 \times 1/8 = 3/16 $$

- 以下は条件付き確率の式から求まる。

$$ P(A∣B) = \frac{P(A \land B)}{P(A)} = 3/5 $$

- 最後の$$ P(A|B) $$のみ、「赤玉を引いたとしたときに、袋がXだった確率」の逆行となっている。

### ベイズの定理の意味

- 以下のベイズの式は、左辺が逆行、右辺が順行となっている点がポイント。

$$ P(A|B)=\frac{P(B|A)P(A)}{P(B)}$$

- 統計的推論では、結果から状態などを推測するため、逆行する。
- これを順行から求められるのが大事なポイントであり、ベイズの定理の有用さ。
- もっというと、順行・逆行は因果関係という話（時間とは限らない）。

## 【ベイズ統計その②】この推定、もっとももっともらしいってよ…！【最尤推定のお話だよ！】

- 参考
  - [https://www.youtube.com/watch?v=5iSZqYh9wOs](https://www.youtube.com/watch?v=5iSZqYh9wOs)

### 推定とは

- 現象から支配パラメータを予想する。
  - 現象: 100回コインを投げて、30回表となった
  - 推測: 3/10が表の出る確率と予想
  - この3/10が支配パラメータの推測結果

### 最尤推定

- 表が出るという確率をp(支配パラメータ)とする。
- n回投げてk回表が出た。(現象)
- この現象の確率は以下で表すことができる。

$$ {}_n \mathrm{C}_k p^{k} (1-p)^{n-k} $$

- しかしこの視点は、神の視点である。
- 庶民の視点は現象が先。
  - n回投げてk回表が出た。(現象)
  - 表が出る確率p_o(支配パラメータ)は何だろうか？
  - もしこの確率がpである場合、現象は$$ {}_n \mathrm{C}_k p^{k} (1-p)^{n-k} $$で発生する。
  - この$$ {}_n \mathrm{C}_k p^{k} (1-p)^{n-k} $$を尤度(likekihood)という。
  - 尤度をL(p)とする。

- 最尤推定とは
  - L(p)が最大になるpをp^とすると、p^がp_oではないの？と推定すること。